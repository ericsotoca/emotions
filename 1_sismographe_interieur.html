<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sismographe Int√©rieur - Reconnexion Corporelle</title>
    
    <style>
        :root {
            --bg-color: #1a1a2e;
            --card-color: #16213e;
            --primary-color: #0f3460;
            --accent-color: #e94560;
            --text-color: #e0e0e0;
            --text-muted-color: #a0a0c0;
            --border-color: #2c3e50;
            --success-color: #50e3c2;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: var(--bg-color); color: var(--text-color); line-height: 1.6; padding: 20px; }
        .container { max-width: 900px; margin: 0 auto; background-color: var(--card-color); padding: 30px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3); }
        header { text-align: center; border-bottom: 2px solid var(--primary-color); padding-bottom: 15px; margin-bottom: 30px; }
        header h1 { color: var(--text-color); font-size: 2.2em; }
        header p { color: var(--text-muted-color); margin-top: 5px; }
        .breathing-section { background-color: var(--primary-color); border: 1px dashed var(--success-color); border-radius: 8px; padding: 20px; margin-bottom: 35px; text-align: center; }
        .breathing-section h2 { font-size: 1.2em; color: var(--success-color); margin-bottom: 10px; }
        .breathing-section p { color: var(--text-muted-color); font-size: 1em; }
        .form-section { margin-bottom: 35px; }
        .form-section h2 { font-size: 1.2em; color: var(--success-color); margin-bottom: 15px; border-bottom: 1px solid var(--border-color); padding-bottom: 8px; }
        .form-section h2 .required { color: var(--accent-color); }
        .sensation-category h3, .detail-section h4 { color: var(--text-muted-color); font-size: 1em; margin-top: 20px; margin-bottom: 10px; }
        .tag-container { display: flex; flex-wrap: wrap; gap: 10px; }
        .tag { background-color: var(--primary-color); color: var(--text-color); border: 2px solid transparent; padding: 8px 15px; border-radius: 20px; cursor: pointer; font-size: 0.9em; transition: all 0.2s ease; }
        .tag:hover { background-color: #1e4f8a; }
        .tag.active { background-color: var(--accent-color); border-color: var(--accent-color); color: white; font-weight: bold; }
        .tag.disabled { opacity: 0.4; pointer-events: none; background-color: #2c3e50; }
        .add-tag-form { display: flex; gap: 10px; margin-top: 15px; }
        .add-tag-form input { flex-grow: 1; width: 100%; padding: 10px; background-color: var(--primary-color); border: 1px solid var(--border-color); border-radius: 8px; font-size: 0.9em; color: var(--text-color); }
        .add-tag-form button { white-space: nowrap; padding: 10px 15px; flex-shrink: 0; font-size: 0.9em; background-color: var(--success-color); color: var(--bg-color); font-weight: bold; border: none; border-radius: 8px; cursor: pointer; }
        .add-tag-form button:hover { background-color: #48c9b0; }
        textarea { width: 100%; padding: 12px; background-color: var(--primary-color); border: 1px solid var(--border-color); border-radius: 8px; font-size: 1em; color: var(--text-color); }
        textarea:focus, .add-tag-form input:focus { outline: none; border-color: var(--accent-color); }
        button[type="submit"] { width: 100%; background-color: var(--accent-color); color: white; border: none; border-radius: 8px; font-size: 1.1em; font-weight: bold; cursor: pointer; padding: 15px; transition: background-color 0.3s, transform 0.1s; }
        button[type="submit"]:hover { background-color: #d13c53; }
        button[type="submit"]:active { transform: scale(0.98); }
        .journal-section { margin-top: 50px; }
        .journal-section h2 { color: var(--text-color); border-bottom: 1px solid var(--border-color); padding-bottom: 10px; }
        #journal-entries { margin-top: 20px; display: grid; grid-template-columns: 1fr; gap: 20px; }
        #no-entries { color: var(--text-muted-color); text-align: center; padding: 40px; border: 2px dashed var(--border-color); border-radius: 8px; }
        .analysis-tip { background-color: var(--primary-color); border-left: 4px solid var(--success-color); padding: 15px; margin: 20px 0; border-radius: 4px; font-size: 0.9em; color: var(--text-muted-color); }
        .entry { background-color: var(--primary-color); border-left: 5px solid var(--accent-color); padding: 20px; border-radius: 8px; position: relative; }
        .entry-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .entry-header h3 { font-size: 1.5em; color: var(--success-color); }
        .entry-header .timestamp { font-size: 0.85em; color: var(--text-muted-color); }
        .entry-content .entry-field { margin-bottom: 12px; }
        .entry-content strong { color: var(--text-muted-color); }
        .entry-content p { margin-left: 10px; white-space: pre-wrap; }
        .delete-btn { position: absolute; top: 10px; right: 10px; background: none; border: none; cursor: pointer; font-size: 1.5em; color: var(--text-muted-color); padding: 5px; }
        .delete-btn:hover { color: var(--accent-color); }
        .journal-actions { margin-top: 20px; display: flex; gap: 15px; }
        .journal-actions button { flex-grow: 1; padding: 15px; font-size: 1em; font-weight: bold; border: none; border-radius: 8px; color: white; cursor: pointer; }
        #clear-journal { background-color: #6c757d; }
        #clear-journal:hover { background-color: #5a6268; }
        #export-journal { background-color: var(--success-color); color: var(--bg-color); }
        #export-journal:hover { background-color: #48c9b0; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Sismographe Int√©rieur</h1>
            <p>"Ressentir dans mon corps avant de pouvoir exprimer."</p>
        </header>
        <main>
            <form id="emotion-form">
                <div class="breathing-section">
                    <h2>√âtape 0 : Une Pause Consciente</h2>
                    <p>Avant de commencer, prenez 3 respirations profondes.<br>Accueillez simplement la sensation dominante dans votre corps, sans la juger.</p>
                </div>
                <div class="form-section">
                    <h2>√âtape 1: Ressentez dans votre corps <span class="required">*</span></h2>
                    <div id="sensation-categories-container"></div>
                </div>
                <div class="form-section">
                    <h2>√âtape 2: Nommez l'√©motion <span class="required">*</span></h2>
                    <div class="tag-container" id="emotion-tags"></div>
                </div>
                <div class="form-section">
                    <h2>√âtape 3: Ajoutez du contexte</h2>
                    <div id="details-sections"></div>
                </div>
                <button type="submit">Enregistrer l'Entr√©e</button>
            </form>
            <section class="journal-section">
                <h2>Mon Journal</h2>
                <div class="analysis-tip" id="analysis-tip-container" style="display: none;">
                    <p><strong>Conseil pour l'analyse :</strong> Pensez √† prendre 30 minutes chaque semaine pour relire vos entr√©es. L'export pour IA est un excellent outil pour identifier des sch√©mas r√©currents et des pistes de croissance.</p>
                </div>
                <div id="journal-entries"></div>
                <div class="journal-actions">
                    <button type="button" id="export-journal" style="display: none;">Exporter pour Analyse IA</button>
                    <button type="button" id="clear-journal" style="display: none;">Effacer tout le journal</button>
                </div>
            </section>
        </main>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const emotionForm = document.getElementById('emotion-form');
        const journalEntriesContainer = document.getElementById('journal-entries');
        const clearJournalButton = document.getElementById('clear-journal');
        const exportJournalButton = document.getElementById('export-journal');
        const analysisTipContainer = document.getElementById('analysis-tip-container');

        const initialData = {
            emotions: ['All√©gresse', 'Amour ‚ù§Ô∏è', 'Amusement', 'Anticipation', 'Anxi√©t√©', 'Calme üßò', 'Col√®re üò°', 'Confiance', 'Contentement üòä', 'Courage', 'Curiosit√©', 'D√©ception', 'D√©go√ªt', 'D√©tente', '√âmerveillement ‚ú®', 'Ennui', 'Espoir', 'Fiert√©', 'Frustration', 'Gratitude üôè', 'Honte', 'Inqui√©tude', 'Irritation', 'Jalousie', 'Joie', 'L√©g√®ret√©', 'Libert√© üïäÔ∏è', 'M√©lancolie', 'Nostalgie', 'Peur', 'Rage', 'Satisfaction', 'S√©r√©nit√©', 'Solitude', 'Soulagement', 'Surprise üòÆ', 'Tristesse üò¢', 'Vuln√©rabilit√©'],
            sensationCategories: [
                { title: 'Ressentis principaux', items: [
                    'Palpitations / rythme cardiaque rapide',
                    'Oppression ou lourdeur thoracique',
                    'Respiration courte / saccad√©e',
                    'Souffle coup√© / √©touffement',
                    'Bouff√©es de chaleur / frissons',
                    'Mains moites / froides',
                    'Tension ou crispation musculaire',
                    'Contraction diaphragmatique / gorge nou√©e',
                    'Serrement des dents / m√¢choire crisp√©e',
                    'Papillons / boule au ventre / crampes abdominales',
                    'Sensation de vide abdominal / engourdissement',
                    'Picotements / chair de poule',
                    'Tremblements / jambes en coton',
                    'Vertiges / sensation de t√™te lourde',
                    'Impression de flottement / d√©connexion corporelle',
                    'D√©tente g√©n√©rale / respiration profonde / √©paules rel√¢ch√©es',
                    'Chaleur agr√©able dans la poitrine / sourire int√©rieur',
                    'L√©g√®ret√© / joie / all√©gresse',
                    'Larmes / yeux humides',
                    'Autre / sensation non list√©e'
                ]}
            ],
            details: [
                { id: 'intensities', title: 'Intensit√©', options: ['Tr√®s faible (1)', 'Faible (2)', 'Moyenne (3)', 'Forte (4)', 'Tr√®s forte (5)'], isMultiSelect: false, isRequired: true },
                { id: 'triggers', title: 'D√©clencheur(s)', initial: ['Interaction sociale', 'Travail ou √©tudes', 'Pens√©es ou souvenirs', 'Famille'], isMultiSelect: true, placeholder: 'Ajouter un nouveau d√©clencheur...' },
                { id: 'besoin_fondamental', title: 'Besoin fondamental', initial: ['S√©curit√©','Lien social','Reconnaissance','Autonomie','R√©alisation personnelle','Sens','Libert√©','Bien-√™tre physique','Apprentissage','Contribution','Spiritualit√© / Connexion √† quelque chose de plus grand'], isMultiSelect: true, placeholder: 'Ajouter un nouveau besoin fondamental...' }
            ]
        };

        // Fonctions createTag, renderTagSection, setupSensationSection, setupDetailSection, loadJournal, displayJournal, exportJournal, escapeHTML et initializeApp restent identiques √† ton code original

        function createTag(text, isMultiSelect = true) {
            const tag = document.createElement('button');
            tag.type = 'button';
            tag.className = 'tag';
            tag.textContent = text;
            tag.addEventListener('click', () => {
                if (!isMultiSelect) {
                    const siblings = tag.closest('.tag-container').querySelectorAll('.tag');
                    if (!tag.classList.contains('active')) siblings.forEach(t => t.classList.remove('active'));
                }
                tag.classList.toggle('active');
            });
            return tag;
        }

        function renderTagSection(container, items, isMultiSelect) {
            container.innerHTML = '';
            items.forEach(item => container.appendChild(createTag(item, isMultiSelect)));
        }

        function setupSensationSection() {
            const container = document.getElementById('sensation-categories-container');
            container.innerHTML = '';
            initialData.sensationCategories.forEach(category => {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'sensation-category';
                const tagContainer = document.createElement('div');
                tagContainer.className = 'tag-container';
                category.items.forEach(item => tagContainer.appendChild(createTag(item, true)));
                categoryDiv.innerHTML = `<h3>${category.title}</h3>`;
                categoryDiv.appendChild(tagContainer);
                container.appendChild(categoryDiv);
            });
        }

        function setupDetailSection(sectionData, container) {
            const isMultiSelect = sectionData.isMultiSelect !== false;
            const requiredSpan = sectionData.isRequired ? ' <span class="required">*</span>' : '';
            const sectionDiv = document.createElement('div');
            sectionDiv.className = 'detail-section';
            const header = document.createElement('h4');
            header.innerHTML = `${sectionData.title}${requiredSpan}`;
            const tagContainer = document.createElement('div');
            tagContainer.className = 'tag-container';
            tagContainer.id = `${sectionData.id}-tags`;
            sectionDiv.appendChild(header);
            sectionDiv.appendChild(tagContainer);
            container.appendChild(sectionDiv);

            let allItems = [...new Set(sectionData.options || sectionData.initial || [])];
            renderTagSection(tagContainer, allItems, isMultiSelect);

            if (sectionData.placeholder) {
                const addForm = document.createElement('div');
                addForm.className = 'add-tag-form';
                const input = document.createElement('input');
                input.type = 'text';
                input.placeholder = sectionData.placeholder;
                const button = document.createElement('button');
                button.type = 'button';
                button.textContent = 'Ajouter';
                button.addEventListener('click', () => {
                    const newTagText = input.value.trim();
                    if (newTagText && !allItems.includes(newTagText)) {
                        allItems.push(newTagText);
                        renderTagSection(tagContainer, allItems, isMultiSelect);
                        input.value = '';
                    }
                });
                addForm.appendChild(input);
                addForm.appendChild(button);
                sectionDiv.appendChild(addForm);
            }
        }

        function initializeApp() {
            setupSensationSection();
            renderTagSection(document.getElementById('emotion-tags'), initialData.emotions, false); 
            const detailsContainer = document.getElementById('details-sections');
            initialData.details.forEach(section => setupDetailSection(section, detailsContainer));
            const descSection = document.createElement('div');
            descSection.className = 'detail-section';
            const descHeader = document.createElement('h4');
            descHeader.textContent = 'Description (optionnel)';
            const descTextarea = document.createElement('textarea');
            descTextarea.id = 'description-textarea';
            descTextarea.rows = 3;
            descTextarea.placeholder = 'Ajouter des pr√©cisions sur le contexte ou vos ressentis...';
            descSection.appendChild(descHeader);
            descSection.appendChild(descTextarea);
            detailsContainer.appendChild(descSection);
        }

        initializeApp();
    });
    </script>
</body>
</html>
