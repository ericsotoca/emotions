<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mon Journal d'√âmotions</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <style>
        body { 
            padding: 20px; 
            background-color: #f8f9fa; 
        }
        .card { 
            margin-bottom: 20px; 
            border: none; 
            box-shadow: 0 4px 8px rgba(0,0,0,0.1); 
        }
        .journal-entry {
            border-left: 5px solid #0d6efd;
            transition: all 0.3s ease-in-out;
        }
        .journal-entry:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
        
        /* --- Style pour transformer les inputs en boutons --- */
        .choice-selector .form-check-input {
            display: none; /* Cache la case √† cocher/le bouton radio */
        }
        .choice-selector .form-check-label {
            cursor: pointer;
            margin-right: 5px; 
            margin-bottom: 5px;
            /* Utilise le style de bouton Bootstrap */
            padding: .375rem .75rem;
            border: 1px solid #0d6efd;
            color: #0d6efd;
            border-radius: .25rem;
            user-select: none;
            transition: all 0.2s ease-in-out;
        }
        /* Style quand l'input est coch√© */
        .choice-selector .form-check-input:checked + .form-check-label {
            background-color: #0d6efd;
            color: white;
            border-color: #0d6efd;
        }
        .form-check {
            padding-left: 0; /* Annule le padding par d√©faut de Bootstrap */
        }
        .badge {
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container mt-4">
        <header class="text-center mb-5">
            <h1>Mon Journal d'√âmotions</h1>
            <p class="lead text-muted">Suivez et comprenez vos √©motions au quotidien. Vos donn√©es sont sauvegard√©es uniquement sur votre appareil.</p>
        </header>

        <!-- Formulaire de saisie -->
        <div class="card p-4">
            <h3 class="text-center mb-4">Nouvelle Entr√©e</h3>
            <form id="emotionForm">

                <!-- √âmotion (s√©lection unique) -->
                <div class="mb-4 choice-selector">
                    <h5>√âmotion <span class="text-danger">*</span></h5>
                    <div class="d-flex flex-wrap">
                        <!-- Les inputs sont des radios pour n'en choisir qu'un -->
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="emotion" id="emo-joie" value="üòä Joie" required><label class="form-check-label" for="emo-joie">üòä Joie</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="emotion" id="emo-tristesse" value="üò¢ Tristesse"><label class="form-check-label" for="emo-tristesse">üò¢ Tristesse</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="emotion" id="emo-colere" value="üò† Col√®re"><label class="form-check-label" for="emo-colere">üò† Col√®re</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="emotion" id="emo-peur" value="üò® Peur"><label class="form-check-label" for="emo-peur">üò® Peur</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="emotion" id="emo-surprise" value="üòÆ Surprise"><label class="form-check-label" for="emo-surprise">üòÆ Surprise</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="emotion" id="emo-degout" value="ü§¢ D√©go√ªt"><label class="form-check-label" for="emo-degout">ü§¢ D√©go√ªt</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="emotion" id="emo-confiance" value="ü§ó Confiance"><label class="form-check-label" for="emo-confiance">ü§ó Confiance</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="emotion" id="emo-anticipation" value="ü§î Anticipation"><label class="form-check-label" for="emo-anticipation">ü§î Anticipation</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="emotion" id="emo-amour" value="‚ù§Ô∏è Amour"><label class="form-check-label" for="emo-amour">‚ù§Ô∏è Amour</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="emotion" id="emo-culpabilite" value="üòî Culpabilit√©"><label class="form-check-label" for="emo-culpabilite">üòî Culpabilit√©</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="emotion" id="emo-honte" value="üò≥ Honte"><label class="form-check-label" for="emo-honte">üò≥ Honte</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="emotion" id="emo-fierte" value="üòé Fiert√©"><label class="form-check-label" for="emo-fierte">üòé Fiert√©</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="emotion" id="emo-calme" value="üòå Calme"><label class="form-check-label" for="emo-calme">üòå Calme</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="emotion" id="emo-anxiete" value="üòü Anxi√©t√©"><label class="form-check-label" for="emo-anxiete">üòü Anxi√©t√©</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="emotion" id="emo-espoir" value="üôè Espoir"><label class="form-check-label" for="emo-espoir">üôè Espoir</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="emotion" id="emo-gratitude" value="üôå Gratitude"><label class="form-check-label" for="emo-gratitude">üôå Gratitude</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="emotion" id="emo-jalousie" value="üòí Jalousie"><label class="form-check-label" for="emo-jalousie">üòí Jalousie</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="emotion" id="emo-ennui" value="üòë Ennui"><label class="form-check-label" for="emo-ennui">üòë Ennui</label></div>
                    </div>
                </div>

                <!-- Intensit√© (s√©lection unique) -->
                <div class="mb-4 choice-selector">
                    <h5>Intensit√© <span class="text-danger">*</span></h5>
                    <div class="d-flex flex-wrap">
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="intensity" id="int-1" value="Tr√®s faible (1)" required><label class="form-check-label" for="int-1">Tr√®s faible (1)</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="intensity" id="int-2" value="Faible (2)"><label class="form-check-label" for="int-2">Faible (2)</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="intensity" id="int-3" value="Moyenne (3)"><label class="form-check-label" for="int-3">Moyenne (3)</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="intensity" id="int-4" value="Forte (4)"><label class="form-check-label" for="int-4">Forte (4)</label></div>
                        <div class="form-check d-inline-block"><input type="radio" class="form-check-input" name="intensity" id="int-5" value="Tr√®s forte (5)"><label class="form-check-label" for="int-5">Tr√®s forte (5)</label></div>
                    </div>
                </div>

                <!-- D√©clencheur (s√©lection multiple) -->
                <div class="mb-4 choice-selector">
                    <h5>D√©clencheur(s)</h5>
                    <div class="d-flex flex-wrap">
                        <!-- Les inputs sont des checkbox pour en choisir plusieurs -->
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="trigger" id="trig-interaction" value="Interaction avec quelqu'un"><label class="form-check-label" for="trig-interaction">Interaction avec quelqu'un</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="trigger" id="trig-social" value="√âv√©nement social"><label class="form-check-label" for="trig-social">√âv√©nement social</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="trigger" id="trig-work" value="Travail ou √©tudes"><label class="form-check-label" for="trig-work">Travail ou √©tudes</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="trigger" id="trig-chores" value="T√¢ches m√©nag√®res"><label class="form-check-label" for="trig-chores">T√¢ches m√©nag√®res</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="trigger" id="trig-thoughts" value="Pens√©es ou souvenirs"><label class="form-check-label" for="trig-thoughts">Pens√©es ou souvenirs</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="trigger" id="trig-health" value="Sant√© ou corps"><label class="form-check-label" for="trig-health">Sant√© ou corps</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="trigger" id="trig-other" value="Autre"><label class="form-check-label" for="trig-other">Autre</label></div>
                    </div>
                </div>

                <!-- R√©action (s√©lection multiple) -->
                <div class="mb-4 choice-selector">
                    <h5>R√©action(s)</h5>
                    <div class="d-flex flex-wrap">
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="reaction" id="react-cried" value="J'ai pleur√©"><label class="form-check-label" for="react-cried">J'ai pleur√©</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="reaction" id="react-laughed" value="J'ai souri ou ri"><label class="form-check-label" for="react-laughed">J'ai souri ou ri</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="reaction" id="react-isolated" value="Je me suis isol√©(e)"><label class="form-check-label" for="react-isolated">Je me suis isol√©(e)</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="reaction" id="react-talked" value="J'ai parl√© √† quelqu'un"><label class="form-check-label" for="react-talked">J'ai parl√© √† quelqu'un</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="reaction" id="react-music" value="J'ai √©cout√© de la musique"><label class="form-check-label" for="react-music">J'ai √©cout√© de la musique</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="reaction" id="react-solution" value="J'ai cherch√© une solution"><label class="form-check-label" for="react-solution">J'ai cherch√© une solution</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="reaction" id="react-nothing" value="Je n'ai rien fait de sp√©cial"><label class="form-check-label" for="react-nothing">Je n'ai rien fait de sp√©cial</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="reaction" id="react-other" value="Autre"><label class="form-check-label" for="react-other">Autre</label></div>
                    </div>
                </div>
                
                <!-- Contexte (s√©lection multiple) -->
                <div class="mb-4 choice-selector">
                    <h5>Contexte(s)</h5>
                    <div class="d-flex flex-wrap">
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="context" id="ctx-home" value="√Ä la maison"><label class="form-check-label" for="ctx-home">√Ä la maison</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="context" id="ctx-work" value="Au travail"><label class="form-check-label" for="ctx-work">Au travail</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="context" id="ctx-transport" value="Dans les transports"><label class="form-check-label" for="ctx-transport">Dans les transports</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="context" id="ctx-public" value="Lieu public"><label class="form-check-label" for="ctx-public">Lieu public</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="context" id="ctx-alone" value="Seul(e)"><label class="form-check-label" for="ctx-alone">Seul(e)</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="context" id="ctx-family" value="Avec la famille"><label class="form-check-label" for="ctx-family">Avec la famille</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="context" id="ctx-friends" value="Avec des amis"><label class="form-check-label" for="ctx-friends">Avec des amis</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="context" id="ctx-morning" value="Matin"><label class="form-check-label" for="ctx-morning">Matin</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="context" id="ctx-afternoon" value="Apr√®s-midi"><label class="form-check-label" for="ctx-afternoon">Apr√®s-midi</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="context" id="ctx-evening" value="Soir"><label class="form-check-label" for="ctx-evening">Soir</label></div>
                        <div class="form-check d-inline-block"><input type="checkbox" class="form-check-input" name="context" id="ctx-other" value="Autre"><label class="form-check-label" for="ctx-other">Autre</label></div>
                    </div>
                </div>

                <!-- Description -->
                <div class="mb-3">
                    <label for="description" class="form-label">Description (optionnel)</label>
                    <textarea class="form-control" id="description" rows="3" placeholder="D√©crivez plus en d√©tail ce qui s'est pass√©..."></textarea>
                </div>
                
                <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-3">
                    <button type="button" class="btn btn-secondary me-md-2" id="cancelButton">Annuler</button>
                    <button type="submit" class="btn btn-success">Sauvegarder</button>
                </div>
            </form>
        </div>

        <!-- Section pour afficher les entr√©es du journal -->
        <div class="mt-5">
            <h2 class="text-center mb-4">Mon Journal</h2>
            <div id="journalEntries" class="list-group">
                <!-- Les entr√©es seront inject√©es ici par JavaScript -->
            </div>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const emotionForm = document.getElementById('emotionForm');
    const journalEntriesContainer = document.getElementById('journalEntries');
    const cancelButton = document.getElementById('cancelButton');
    const STORAGE_KEY = 'emotionJournalEntries';

    /**
     * R√©cup√®re les entr√©es depuis le localStorage.
     * @returns {Array} Un tableau d'objets d'entr√©e.
     */
    const getEntries = () => {
        const entries = localStorage.getItem(STORAGE_KEY);
        return entries ? JSON.parse(entries) : [];
    };

    /**
     * Sauvegarde les entr√©es dans le localStorage.
     * @param {Array} entries - Le tableau d'entr√©es √† sauvegarder.
     */
    const saveEntries = (entries) => {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(entries));
    };

    /**
     * Affiche toutes les entr√©es du journal dans le DOM.
     */
    const renderJournal = () => {
        journalEntriesContainer.innerHTML = '';
        const entries = getEntries();

        if (entries.length === 0) {
            journalEntriesContainer.innerHTML = '<p class="text-center text-muted">Aucune entr√©e pour le moment. Ajoutez-en une !</p>';
            return;
        }

        // Affiche les entr√©es de la plus r√©cente √† la plus ancienne
        entries.slice().reverse().forEach(entry => {
            const entryElement = document.createElement('div');
            entryElement.className = 'list-group-item list-group-item-action flex-column align-items-start mb-3 p-3 journal-entry';
            
            // Fonction pour cr√©er des badges pour les s√©lections multiples
            const createBadges = (items) => {
                if (!items || items.length === 0) return '<span class="badge bg-light text-dark">Non sp√©cifi√©</span>';
                return items.map(item => `<span class="badge bg-secondary me-1 mb-1">${item}</span>`).join('');
            };

            entryElement.innerHTML = `
                <div class="d-flex w-100 justify-content-between">
                    <h5 class="mb-1">√âmotion : ${entry.emotion}</h5>
                    <small class="text-muted">${new Date(entry.id).toLocaleString('fr-FR')}</small>
                </div>
                <p class="mb-1"><strong>Intensit√© :</strong> <span class="badge bg-primary">${entry.intensity}</span></p>
                <div class="mb-1"><strong>D√©clencheur(s) :</strong> ${createBadges(entry.triggers)}</div>
                <div class="mb-1"><strong>R√©action(s) :</strong> ${createBadges(entry.reactions)}</div>
                <div class="mb-2"><strong>Contexte(s) :</strong> ${createBadges(entry.contexts)}</div>
                ${entry.description ? `<p class="mb-1 fst-italic text-muted">"${entry.description}"</p>` : ''}
                <button class="btn btn-sm btn-outline-danger mt-2 delete-btn" data-id="${entry.id}">Supprimer</button>
            `;
            journalEntriesContainer.appendChild(entryElement);
        });
    };

    /**
     * G√®re la soumission du formulaire.
     */
    emotionForm.addEventListener('submit', (e) => {
        e.preventDefault();

        // R√©cup√©rer les valeurs des champs de type "checkbox"
        const getCheckedValues = (name) => {
            return Array.from(document.querySelectorAll(`input[name="${name}"]:checked`)).map(cb => cb.value);
        };
        
        const newEntry = {
            id: Date.now(), // Utilise le timestamp comme ID unique
            emotion: emotionForm.elements['emotion'].value,
            intensity: emotionForm.elements['intensity'].value,
            triggers: getCheckedValues('trigger'),
            reactions: getCheckedValues('reaction'),
            contexts: getCheckedValues('context'),
            description: emotionForm.elements['description'].value.trim()
        };

        const entries = getEntries();
        entries.push(newEntry);
        saveEntries(entries);

        renderJournal();
        emotionForm.reset(); // R√©initialise le formulaire
    });

    /**
     * G√®re la suppression d'une entr√©e.
     */
    journalEntriesContainer.addEventListener('click', (e) => {
        if (e.target.classList.contains('delete-btn')) {
            const entryId = e.target.getAttribute('data-id');
            if (confirm("√ätes-vous s√ªr de vouloir supprimer cette entr√©e ?")) {
                let entries = getEntries();
                entries = entries.filter(entry => entry.id.toString() !== entryId);
                saveEntries(entries);
                renderJournal();
            }
        }
    });
    
    /**
     * G√®re le bouton Annuler.
     */
    cancelButton.addEventListener('click', () => {
        emotionForm.reset();
    });

    // Affichage initial du journal au chargement de la page
    renderJournal();
});
</script>
</body>
</html>
